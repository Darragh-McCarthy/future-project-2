


<div class="prediction" ng-class="{'prediction--expanded': predictionCtrl.prediction.isExpanded}">

  <input type="button" class="prediction__toggle-edit-topics" ng-show=" ! predictionCtrl.showTopicEditingByDefault && ! predictionCtrl.isEditingTopics" value="Edit" ng-click="predictionCtrl.toggleEditing()" />
  <input type="button" class="prediction__toggle-edit-topics" ng-show=" ! predictionCtrl.showTopicEditingByDefault && predictionCtrl.isEditingTopics" value="Back" ng-click="predictionCtrl.toggleEditing()" />
  <div class="prediction__header">
    <a class="prediction__title" href="#">{{::predictionCtrl.prediction.title}}</a>
      <span class="prediction__topics-not-set-notice" ng-show="predictionCtrl.isEditingTopics && predictionCtrl.prediction.topics.length === 0">This prediction appears in <b>0 topics</b>. Add at least one relevant topic</span>
    <span class="prediction__topics" ng-class="{'editing-prediction-topics': predictionCtrl.isEditingTopics}">
      <!--<button class="prediction__topics__add-topic-button">Add topics</button>-->
      <span class="prediction__topic" ng-repeat="topic in predictionCtrl.prediction.topics" ng-click="predictionCtrl.navigateToTopic(topic.title)">
        {{topic.title}} <span class="edit-prediction__delete-topic" ng-click="predictionCtrl.removeTopicFromPrediction(topic.id)">Ã—</span>
      </span>
      <span class="prediction__topic__preview-while-saving" ng-if="predictionCtrl.topicIsSavingMessage"><b>Adding</b> {{predictionCtrl.topicIsSavingMessage}}</span>
    </span>
    <!--<span class="prediction__created-at">{{::predictionCtrl.prediction.createdAt}}</span>-->
  </div>

  


  <div class="edit-prediction">

    <form class="edit-prediction__add-topics" ng-if="predictionCtrl.isEditingTopics && predictionCtrl.prediction.topics.length < predictionCtrl.maxTopicsPerPrediction">
      <label class="edit-prediction__add-topics-label" for="edit-prediction__topic-title-input">
        <span ng-show="predictionCtrl.prediction.topics.length === 0">Add Topic</span>
        <span ng-show="predictionCtrl.prediction.topics.length > 0">Add topic</span>
      </label>
      <input type="text" id="edit-prediction__topic-title-input" ng-model="predictionCtrl.newTopicTitle" />
      <button class="edit-prediction__add-topic-button" 
        ng-show="predictionCtrl.newTopicTitle.length >= 2" 
        ng-click="predictionCtrl.addTopicFromInputToPrediction()">
        Add topic
      </button>

      <div class="edit-prediction__suggested-topics" ng-if="predictionCtrl.prediction.topics.length === 0">
        <span class="edit-prediction__suggested-topics-title">Suggestions:</span>
        <ul class="edit-prediction__suggested-topics-list">
          <li class="edit-prediction__suggested-topics-topic" ng-repeat="suggestedTopicTitle in predictionCtrl.suggestedTopicTitles" ng-click="predictionCtrl.addTopicFromSuggestedTopics($index)">{{suggestedTopicTitle}}</li>
        </ul>
      </div>

    </form>


    <div class="next-container" ng-if="predictionCtrl.isEditingTopics && predictionCtrl.prediction.topics.length">
      <input type="button" class="prediction-next-step" value="Done"  ng-click="predictionCtrl.toggleEditing()" />
    </div>

  </div>



  <div class="likelihood" ng-if="predictionCtrl.isLikelihoodSelectionVisible">
    <div class="likelihood__community-estimate">
      <div ng-if="predictionCtrl.prediction.isExpanded">
        <div class="likelihood__community-estimate__count">{{predictionCtrl.prediction.communityEstimatesCount}} votes</div>
        <div class="likelihood__community-estimate__graph">
          <div class="likelihood__community-estimate__graph-bar" ng-repeat="estimate in predictionCtrl.prediction.communityEstimates">
            <div ng-style="estimate.graphBarHeight"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="likelihood__user-estimate">
      <div class="likelihood__user-estimate-option" 
        ng-click="predictionCtrl.toggleLikelihoodEstimate(estimate.percent)" 
        ng-repeat="estimate in predictionCtrl.prediction.communityEstimates track by $index" 
        ng-class="{'likelihood__user-estimate-option--active': estimate.percent == predictionCtrl.prediction.userEstimate.likelihoodEstimatePercent}">
          {{::estimate.percent}}<span class="show-on-active">%<br/>likely</span>
      </div>
    </div>
  </div>



</div>




